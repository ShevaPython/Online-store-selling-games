{% extends 'shop/index.html' %}
{% block title %}{{ game.name }}{% endblock %}


{% block content %}
<body>

<div class="page-wrapper">
    <!-- Preloader -->
    <div class="preloader"><div class="icon"></div></div>



        <!--Sidebar Page Container-->
    <div class="sidebar-page-container">
        <div class="auto-container">
            <div class="row clearfix">

                <!--Content Side / Blog Detail-->
                <div class="content-side col-lg-8 col-md-12 col-sm-12">
                    <div class="blog-detail">
                		<div class="image-box">
                			<figure class="image"><img src="{{ game.photo }}" alt=""></figure>
                		</div>
                		<div class="lower-content">
                			<div class="post-date">       {% if current_user.is_authenticated %}
                                        <form id="add-to-basket-form"
                                              action="{{ url_for('basket.add_basket', game_id=game.id) }}"
                                              method="post">
                                            <button type="submit" class="add-to-basket-btn">Add to Basket</button>
                                        </form>
                                    {% else %}
                                        <form action="{{ url_for('auth.login_page') }}" method="get">
                                            <button type="submit" class="add-to-basket-btn">Add to Basket</button>
                                        </form>
                                    {% endif %}</div>
							<h3>{{ game.name}}</h3>
							<ul class="post-info">
								<li><a href="#">2 Comments</a></li>
								<li><a href="#">15 Likes</a></li>
							</ul>
							<p>{{ game.description }}</p>
                		</div>
                    </div>



                      <!--Comment Form-->
                    <div class="comment-form">
                        <div class="group-title"><h3>Leave a comment</h3></div>

                        <form method="post" action="">
                            <div class="row clearfix">
                                <div class="col-md-6 col-sm-12 form-group">
                                    <input type="text" name="username" placeholder="Full name" required="">
                                </div>

                                <div class="col-md-6 col-sm-12 form-group">
                                    <input type="email" name="email" placeholder="Email address" required="">
                                </div>

                                <div class="col-md-12 col-sm-12 form-group">
                                    <textarea name="message" placeholder="Write a comment"></textarea>
                                </div>

                                <div class="col-md-12 col-sm-12 form-group">
                                    <button class="theme-btn btn-style-one" type="submit" name="submit-form"><span class="btn-title">Post Comment</span></button>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div></div>

                    <!-- Comments Area -->
                    <div class="comments-area">
                        <div class="group-title"><h3>2 Comments</h3></div>
                        <div class="comment-box">
                            <div class="comment">
                                <div class="author-thumb">
                                    <figure class="thumb"><img src="" alt=""></figure>
                                </div>
                                <h4 class="name">Kevin Martin</h4>
                                <div class="text">Lorem ipsum is simply free text used by copytyping refreshing. Neque porro est qui dolorem ipsum quia quaed inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo var sed efficitur turpis gilla sed sit amet finibus eros.</div>
                                <a href="#" class="reply-btn">Reply</a>
                            </div>
                        </div>

                        <div class="comment-box reply-comment">
                            <div class="comment">
                                <div class="author-thumb">
                                    <figure class="thumb"><img src="" alt=""></figure>
                                </div>
                                <h4 class="name">Sarah Albert</h4>
                                <div class="text">Lorem ipsum is simply free text used by copytyping refreshing. Neque porro est qui dolorem ipsum quia quaed inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo var sed efficitur turpis gilla sed sit amet finibus eros.</div>
                                <a href="#" class="reply-btn">Reply</a>
                            </div>
                        </div>
                    </div>


                </div>

                <!--Sidebar Side-->
                <div class="sidebar-side col-lg-4 col-md-12 col-sm-12">
                    <aside class="sidebar">
                    	<!-- Search -->
                        <div class="sidebar-widget search-box">
                                   <form method="GET" action={{ url_for('blog.show_one_game') }}>
                                <div class="form-group">
                                    <input type="search" name="search" value="{{ request.args.get('search','') }}" placeholder="Search" required>
                                    <button type="submit"><span class="icon fa fa-search"></span></button>
                                </div>
                            </form>
                        </div>





                        <div class="sidebar-widget categories">
                            <div class="widget-content">
                                <h4 class="sidebar-title">Categories</h4>
                                {% for genre in genres() %}
                                <ul class="blog-categories">
                                    <li><a href="{{ url_for('blog.all_game_page', gerne_name=genre.name) }}">{{ genre.name }}</a>

                                </ul>
                                 {% endfor %}
                            </div>
                        </div>

                    </aside>
                </div>
            </div>
        </div>
    </div>
    <!-- End Sidebar Page Container -->

	<!-- Main Footer -->
    <footer class="main-footer">
    	<div class="auto-container">
        	<!--Widgets Section-->
            <div class="widgets-section">
            	<div class="row clearfix">

                    <!--Column-->
                    <div class="column col-lg-4 col-md-6 col-sm-12">
						<div class="footer-widget logo-widget">
							<div class="logo">
                            	<a href="index.html"><img src="" alt="" /></a>
                            </div>
							<div class="text">There are many variations of passages of lorem ipsum available, but the majority have suffered alteration in some form by injected.</div>
						</div>
					</div>

					<!--Column-->
                    <div class="column col-lg-4 col-md-6 col-sm-12">
						<div class="footer-widget links-widget">
							<div class="widget-content">
								<div class="footer-title">
									<h2>Links</h2>
								</div>
								<div class="row clearfix">
									<div class="column col-lg-6 col-md-6 col-sm-12">
										<ul class="list">
											<li><a href="#">About</a></li>
											<li><a href="#">Our Team</a></li>
											<li><a href="#">Gallery</a></li>
											<li><a href="#">Contact</a></li>
										</ul>
									</div>
									<div class="column col-lg-6 col-md-6 col-sm-12">
										<ul class="list">
											<li><a href="#">Help & Support</a></li>
											<li><a href="#">Privacy Policy</a></li>
											<li><a href="#">Terms of Use</a></li>
										</ul>
									</div>
								</div>
							</div>
						</div>
					</div>

					<!--Column-->
                    <div class="column col-lg-4 col-md-6 col-sm-12">
						<div class="footer-widget newsletter-widget">
							<div class="footer-title">
                            	<h2>Newsletter</h2>
                            </div>
							<div class="text">Subsrcibe us now to get the latest news and updates</div>
							<div class="newsletter-form">
                                <form method="post" action="contact.html">
                                    <div class="form-group clearfix">
                                        <input type="email" name="email" value="" placeholder="Email address" required>
                                        <button type="submit" class="theme-btn newsletter-btn"><span class="fas fa-envelope"></span></button>
                                    </div>
                                </form>
                            </div>
						</div>
					</div>

				</div>
			</div>
		</div>

		<!-- Footer Bottom -->
		<div class="footer-bottom">
			<div class="auto-container">
				<!--Scroll to top-->
				<div class="scroll-to-top scroll-to-target" data-target="html"><span class="flaticon-up-arrow"></span></div>
				<!--Scroll to top-->
				<div class="row clearfix">
					<!-- Column -->
					<div class="column col-lg-6 col-md-12 col-sm-12">
						<div class="copyright">&copy; Copyrights, 2019 All Rights Reserved</div>
					</div>
					<!-- Column -->
					<div class="column col-lg-6 col-md-12 col-sm-12">
						<ul class="social-icons">
							<li><a href="#"><span class="fab fa-twitter"></span></a></li>
							<li><a href="#"><span class="fab fa-facebook-square"></span></a></li>
							<li><a href="#"><span class="fab fa-pinterest-p"></span></a></li>
							<li><a href="#"><span class="fab fa-instagram"></span></a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</footer>

</div>
    <script>

        // Обработчик события отправки формы
        document.addEventListener('submit', function (event) {
            if (event.target.matches('#add-to-basket-form')) {
                event.preventDefault(); // Предотвращаем отправку формы

                // Отправляем AJAX-запрос на сервер
                fetch(event.target.action, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                })
                    .then(response => response.json())
                    .then(data => {
                        if (data.message === 'Game has been successfully added to the basket') {
                            // Отображаем сообщение об успешном добавлении игры
                            alert('Game has been successfully added to the basket');

                        } else {
                            // Отображаем сообщение об ошибке
                            alert('Failed to add the game to the basket');
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error);
                    });
            }
        });
    </script>

</body>
{% endblock  %}